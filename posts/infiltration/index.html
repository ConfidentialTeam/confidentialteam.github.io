<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        Infiltrating CS Beacon through out different mediums ::
        Confidential Team — UnKn0wn
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Introduction: Hello Everyone, We all have heard of many infiltration techniques that were widely used making them easy to be detected. so we at Confidential took a step toward an infiltration technique that will make it a bit more complex in order not to be detected by any sense. Today&amp;rsquo;s article will clarify how we have infiltrated CS beacon through out different mediums.
Brief We splitted the CS beacon into multiple chunks that will be later infiltrated from different mediums (DNS txt record, custome HTTP response header, and SMTP server&amp;rsquo;s banner) using an executable agent that we will show a full demo about at the end of the article."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/infiltration/" />





<link rel="stylesheet" href="/assets/style.css" />

<link rel="stylesheet" href="/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="/img/favicon.png" />


<link href="/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Infiltrating CS Beacon through out different mediums"/>
<meta name="twitter:description" content="Introduction: Hello Everyone, We all have heard of many infiltration techniques that were widely used making them easy to be detected. so we at Confidential took a step toward an infiltration technique that will make it a bit more complex in order not to be detected by any sense. Today&rsquo;s article will clarify how we have infiltrated CS beacon through out different mediums.
Brief We splitted the CS beacon into multiple chunks that will be later infiltrated from different mediums (DNS txt record, custome HTTP response header, and SMTP server&rsquo;s banner) using an executable agent that we will show a full demo about at the end of the article."/>



<meta property="og:title" content="Infiltrating CS Beacon through out different mediums" />
<meta property="og:description" content="Introduction: Hello Everyone, We all have heard of many infiltration techniques that were widely used making them easy to be detected. so we at Confidential took a step toward an infiltration technique that will make it a bit more complex in order not to be detected by any sense. Today&rsquo;s article will clarify how we have infiltrated CS beacon through out different mediums.
Brief We splitted the CS beacon into multiple chunks that will be later infiltrated from different mediums (DNS txt record, custome HTTP response header, and SMTP server&rsquo;s banner) using an executable agent that we will show a full demo about at the end of the article." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/infiltration/" />
<meta property="article:published_time" content="2022-01-03T16:56:40-05:00" />
<meta property="article:modified_time" content="2022-01-03T16:56:40-05:00" /><meta property="og:site_name" content="Confidential Team" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >Confidential Team</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">Infiltrating CS Beacon through out different mediums</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2022-01-03
        </span>

        
          
        
      

      


      
        <span class="post-read-time"
          >— 2 min read</span
        >
      
    </div>

    

    

    <div class="post-content">
      
      <h2 id="introduction">Introduction:</h2>
<p>Hello Everyone, We all have heard of many infiltration techniques that were widely used making them easy to be detected. so we at Confidential took a step toward an infiltration technique that will make it a bit more complex in order not to be detected by any sense. Today&rsquo;s article will clarify how we have infiltrated CS beacon through out different mediums.</p>
<h2 id="brief">Brief</h2>
<p>We splitted the CS beacon into multiple chunks that will be later infiltrated from different mediums (DNS txt record, custome HTTP response header, and SMTP server&rsquo;s banner) using an executable agent that we will show a full demo about at the end of the article.</p>
<h2 id="dns-txt-record">DNS txt record:</h2>
<p>TXT records are a type of Domain Name System (DNS) record that contains text information. According to Google</p>
<p>Simply we can add our CS beacon&rsquo;s chunked as a txt dns record so when we perform a txt DNS query it will be resolved by the DNS Server resulting in getting the chunked part.</p>
<pre><code>nslookup -querytype=txt confidential.example.com
</code></pre><p><img src="../../img/infiltration/1.png" alt=""></p>
<h2 id="http-response-header">HTTP Response Header:</h2>
<p>We configured our web server Response header so that we have the 2nd CS beacon&rsquo;s chunk in a custom response header called <code>Confidential</code>.</p>
<p><img src="../../img/infiltration/3.png" alt=""></p>
<h2 id="smtp-servers-banner">SMTP Server&rsquo;s Banner:</h2>
<p>We set up our SMTP Server and modified its configuration adding up the last chunck in the SMTP server&rsquo;s banner.</p>
<p><img src="../../img/infiltration/2.png" alt=""></p>
<h2 id="demo">Demo</h2>
<p>Our team developed a tool that automates the process with more features. Here&rsquo;s a demo of the executable agent that we fired up inside the compromised windows machine.</p>
<p><img src="../../img/infiltration/4.gif" alt=""></p>
<p><img src="../../img/infiltration/5.png" alt=""></p>
<p>All techniques mentioned above are just limited examples of how you can infiltrate your malicious payload to the compromised machine. You still can come up with your own ideas that suits the scenario</p>
<h2 id="refrences">Refrences:</h2>
<ul>
<li><a href="https://support.google.com/a/answer/2716800?hl=en">https://support.google.com/a/answer/2716800?hl=en</a></li>
<li><a href="https://github.com/PaloAltoNetworks/research-notes/blob/master/notes/DNS-based%20data%20exfiltration%20and%20infiltration%20technology%20and%20detection.pdf">https://github.com/PaloAltoNetworks/research-notes/blob/master/notes/DNS-based%20data%20exfiltration%20and%20infiltration%20technology%20and%20detection.pdf</a></li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="/posts/infiltrationar/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Infiltrationar</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="/posts/memorypatching/">
                  <span class="button__text">Memory Patching (AMSI Bypass)</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >Confidential Team</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span
          >© 2022 Powered by
          <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span
        >
        <span
          >Theme created by
          <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span
        >
      </div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
